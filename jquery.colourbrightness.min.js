/*
 *  colourBrightness.js
 *
 *  Copyright 2013-2016, Jamie Brittain - http://jamiebrittain.com
 *  Released under the WTFPL license
 *  http://sam.zoy.org/wtfpl/
 *
 *  Github:  http://github.com/jamiebrittain/colourBrightness.js
 *  Version: 1.2
 */
jQuery.fn.colourBrightness=function(){function r(r,a,t,e,s,n){var p=.2126*Math.pow(r/255,2.2)+.7152*Math.pow(a/255,2.2)+.0722*Math.pow(t/255,2.2),h=.2126*Math.pow(e/255,2.2)+.7152*Math.pow(s/255,2.2)+.0722*Math.pow(n/255,2.2);return h<p?(.05+p)/(.05+h):(.05+h)/(.05+p)}function s(r){var a,t,e,s;return r.match(/^rgb/)?(a=(r=(r=r.match(/rgba?\(([^)]+)\)/)[1]).split(/ *, */).map(Number))[0],t=r[1],e=r[2],s=r[3]||1):"#"==r[0]&&7==r.length?(a=parseInt(r.slice(1,3),16),t=parseInt(r.slice(3,5),16),e=parseInt(r.slice(5,7),16),s=1):"#"==r[0]&&4==r.length&&(a=parseInt(r[1]+r[1],16),t=parseInt(r[2]+r[2],16),e=parseInt(r[3]+r[3],16),s=1),{r:a,g:t,b:e,a:s}}var a=function(r){for(var a=[];"html"!=r[0].tagName.toLowerCase()&&("rgba(0, 0, 0, 0)"==(t=r.css("background-color"))||"transparent"==t||(a.push(t),!t.match(/^rgb/)||1!=((t=(t=t.match(/rgba?\(([^)]+)\)/)[1]).split(/ *, */).map(Number))[3]||1)));)r=r.parent();for(a.reverse();1<a.length;){var t=s(a[0]),e=s(a[1]);e.a<1&&(e.r=(1-e.a)*t.r+e.a*e.r,e.g=(1-e.a)*t.g+e.a*e.g,e.b=(1-e.a)*t.b+e.a*e.b,e.a=1,a[0]="rgb("+parseInt(e.r)+", "+parseInt(e.g)+", "+parseInt(e.b)+")"),a.splice(1,1)}return a[0]}(this);return r((a=s(a)).r,a.g,a.b,255,255,255)>r(a.r,a.g,a.b,0,0,0)?this.removeClass("light").addClass("dark"):this.removeClass("dark").addClass("light"),this};
